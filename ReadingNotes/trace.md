## 关键指标

**可观测能力**是系统能否根据生成的外部数据(通常是日志、指标和跟踪)来研判系统内部运行情况的能力

M.E.L.T (指标 Metrix,事件 Event,日志 Log,跟踪 Traces)
日志、指标和跟踪构成了所有以事件驱动的远程监测的主要部分

- Event
- Logs
- Metrix: 虽然日志并不总是可访问的，但往往可以通过查询访问大多数指标
- Traces: 是一种从头到尾跟踪流程(如，API 请求或其他系统活动)的行为，展示了服务之间的关联

## OpenTelemetry (OTel)

OTel 是一个开源可观测能力框架，由一系列工具、API 和 SDK 组成。
其目标是提高数据收集的系统无关性，规范远程遥测

```txt
┌--------------------------------------------------┐
|                                                  |
| The App                                          |
|              ┌--------------------------------- OTel ------------------------------------------┐
|              |                                   |                                             |
|   Event ==> API => SDK => Processor => Exporter ==> Collector => Exporter => Telemetry Backend |
|              |                                   |                                             |
|              └-----------------------------------|---------------------------------------------┘
└--------------------------------------------------┘
```

- `Instrumentation`: 用于添加具体的观测能力
- `Resource`: 表示 APP 的具体信息
- `Tracer`: 在 App 中工作的对象，由 `TracerProvider` 创建
- `Span`: 最小遥测单元，包含了 name, timestamp, structured message, metadata 等，保证了追踪的有效性
- `Context`: 最小传输单元，保证了多个 服务/API 之间的传输逻辑链
  - `Propagator`: 结构化工具，保证了 `Context` 能在对应服务之间正确的序列化和反序列化
- `Exporter`: 用于传输跟踪数据到具体服务
- `Sampling`: 用于限制 App 生成传输的 Span，防止遥测影响到性能
